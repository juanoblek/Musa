<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Modal Video</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>ðŸ§ª Test Modal Video Fix</h1>
        <p>Click en los botones para probar el modal con videos</p>
        
        <div class="row">
            <div class="col-md-4">
                <button class="btn btn-primary" onclick="testVideo('uploads/video_68f276851285d_1760720517.mp4', 'asdasdsa')">
                    ðŸŽ¬ Test: asdasdsa
                </button>
            </div>
            <div class="col-md-4">
                <button class="btn btn-success" onclick="testVideo('uploads/video_68f11d67ce55c_1760632167.mp4', 'Chaqueta Nueva Era')">
                    ðŸŽ¬ Test: Chaqueta Nueva Era  
                </button>
            </div>
            <div class="col-md-4">
                <button class="btn btn-warning" onclick="testVideo('uploads/video_68f0254985a91_1760568649.mp4', 'Chaqueta See')">
                    ðŸŽ¬ Test: Chaqueta See
                </button>
            </div>
        </div>
        
        <div class="mt-4">
            <button class="btn btn-secondary" onclick="testImage('images/placeholder.svg', 'Test Imagen')">
                ðŸ“¸ Test: Imagen Placeholder
            </button>
        </div>
    </div>

    <!-- Modal de prueba -->
    <div class="modal fade" id="testModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="testModalTitle">Test Modal</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="testMediaContainer" style="text-align: center; min-height: 400px;">
                        <!-- El contenido multimedia se insertarÃ¡ aquÃ­ -->
                    </div>
                    <div class="mt-3">
                        <h6>Debug Info:</h6>
                        <div id="debugInfo" class="bg-light p-2 rounded small"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function testVideo(videoUrl, productName) {
            console.log('ðŸ§ª Testing video:', videoUrl);
            
            // Detectar si es video
            const isVideo = /\.(mp4|mov|avi|webm)$/i.test(videoUrl);
            
            console.log('ðŸ“¹ Is video detected:', isVideo);
            
            // Crear elemento multimedia
            const mediaElement = isVideo 
                ? `<video src="${videoUrl}" 
                         class="img-fluid" 
                         style="max-height: 80vh; max-width: 100%; object-fit: contain; border-radius: 8px;"
                         controls autoplay muted loop playsinline
                         onerror="console.error('Error loading video:', '${videoUrl}');">
                         Tu navegador no soporta la reproducciÃ³n de video.
                   </video>`
                : `<img src="${videoUrl}" 
                       class="img-fluid" 
                       style="max-height: 80vh; max-width: 100%; object-fit: contain; border-radius: 8px;"
                       onerror="this.src='images/placeholder.svg'; console.error('Error loading image:', '${videoUrl}');">`;
            
            // Actualizar modal
            document.getElementById('testModalTitle').textContent = productName;
            document.getElementById('testMediaContainer').innerHTML = mediaElement;
            document.getElementById('debugInfo').innerHTML = `
                <strong>URL:</strong> ${videoUrl}<br>
                <strong>Is Video:</strong> ${isVideo}<br>
                <strong>Element Type:</strong> ${isVideo ? 'VIDEO' : 'IMAGE'}<br>
                <strong>Timestamp:</strong> ${new Date().toLocaleString()}
            `;
            
            // Mostrar modal
            const modal = new bootstrap.Modal(document.getElementById('testModal'));
            modal.show();
        }
        
        function testImage(imageUrl, productName) {
            testVideo(imageUrl, productName); // Usa la misma lÃ³gica
        }
    </script>
</body>
</html>