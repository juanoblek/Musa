<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Producto de Prueba</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">üß™ Crear Producto de Prueba con Colores Hexadecimales</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-success btn-lg w-100" onclick="createTestProduct()">
                            <i class="fas fa-plus me-2"></i>Crear Producto de Prueba
                        </button>
                        <div id="result" class="mt-4"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function createTestProduct() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="text-center"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Creando producto...</span></div><p class="mt-2">Creando producto de prueba...</p></div>';
            
            const testProductData = {
                name: "Camisa Premium Test Hex",
                description: "Camisa de prueba para validar colores hexadecimales y selectores interactivos",
                price: 89000,
                sale_price: 67000,
                stock_quantity: 25,
                category_id: "camisas",
                gender: "unisex",
                status: "active",
                is_featured: true,
                colors: [
                    {
                        nombre: "Rojo Elegante",
                        codigo_hex: "#dc3545",
                        hex: "#dc3545"
                    },
                    {
                        nombre: "Azul Profundo",
                        codigo_hex: "#0d6efd", 
                        hex: "#0d6efd"
                    },
                    {
                        nombre: "Verde Natura",
                        codigo_hex: "#198754",
                        hex: "#198754"
                    },
                    {
                        nombre: "P√∫rpura Real",
                        codigo_hex: "#6f42c1",
                        hex: "#6f42c1"
                    }
                ],
                sizes: ["S", "M", "L", "XL", "XXL"],
                main_image: "images/placeholder.svg"
            };

            try {
                const response = await fetch('api/productos.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testProductData)
                });

                const result = await response.json();
                console.log('API Response:', result);

                if (result.success) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            <h6>‚úÖ Producto Creado Exitosamente</h6>
                            <p><strong>Nombre:</strong> ${result.product.name}</p>
                            <p><strong>ID:</strong> ${result.product.id}</p>
                            <p><strong>Colores:</strong> ${result.product.colors ? JSON.parse(result.product.colors).length : 0} colores</p>
                            <p><strong>Tallas:</strong> ${result.product.sizes ? JSON.parse(result.product.sizes).length : 0} tallas</p>
                        </div>
                        <div class="mt-3">
                            <h6>üé® Colores creados:</h6>
                            <div class="d-flex gap-2">
                                ${JSON.parse(result.product.colors || '[]').map(color => `
                                    <div class="text-center">
                                        <div style="width: 40px; height: 40px; background: ${color.codigo_hex || color.hex}; border-radius: 50%; border: 2px solid #ddd; margin: 0 auto;"></div>
                                        <small class="d-block mt-1">${color.nombre || color.name}</small>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="mt-3">
                            <a href="index.html" class="btn btn-primary me-2" target="_blank">
                                <i class="fas fa-eye me-1"></i>Ver en Frontend
                            </a>
                            <a href="admin-panel.html" class="btn btn-secondary" target="_blank">
                                <i class="fas fa-cog me-1"></i>Ver en Admin
                            </a>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <h6>‚ùå Error al Crear Producto</h6>
                            <p>${result.error || result.message || 'Error desconocido'}</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h6>‚ùå Error de Conexi√≥n</h6>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
